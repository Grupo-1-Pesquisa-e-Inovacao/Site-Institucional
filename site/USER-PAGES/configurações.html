<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configurações - GeoEduca</title>
  <link rel="stylesheet" href="../CSS/navbar.css" />
  <link rel="stylesheet" href="../CSS/admim.css">
  <link rel="icon" type="image/png" href="../IMGS/LOGO-IMG.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body>

  <!-- NAVBAR -->
  <header class="navbar">
    <div class="logo"></div>
    <nav>
      <ul>
        <li><a href="usuario.html">Início</a></li>
        <li><a href="perfil.html">Meu Perfil</a></li>
        <li><a href="dashboard.html">Dashboard</a></li>
        <li><a href="configurações.html" style="color: orange;">Configurações</a></li>
        <li><a href="../index.html" class="logout-btn"><i class="fa-solid fa-right-from-bracket"></i> Sair</a></li>
      </ul>
    </nav>
  </header>

  <!-- TOPO VISUAL -->
  <div class="container-principal">
    <section class="container-topo">
      <h1>Configurações da Conta</h1>
      <h3>Personalize suas informações e preferências no GeoEduca.</h3>
    </section>

   <!-- Slack -->
<section class="funcionalidades">
  <h2><i class="fa-brands fa-slack"></i> Configurar Canais do Slack</h2>
  
  <!-- Adicionar novo canal -->
  <table class="user-table">
    <thead>
      <tr>
        <th>Novo Canal</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input type="text" id="novoCanalSlack" placeholder="Digite o nome do canal Slack" /></td>
        <td><button class="action-btn" id="btnAdicionarSlack">Adicionar</button></td>
      </tr>
    </tbody>
  </table>

  <!-- Lista de canais existentes -->
  <h3 style="margin-top:20px;">Canais Configurados</h3>
  <table class="user-table" id="tabelaSlack">
    <thead>
      <tr>
        <th>Canal</th>
        <th>Status</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <!-- Exemplo inicial -->
      <tr>
        <td>#geoeduca-info</td>
        <td><span class="status ativo">Ativo</span></td>
        <td>
          <button class="action-btn btnToggle">Desligar</button>
          <button class="action-btn btnDelete">Deletar</button>
        </td>
      </tr>
      <tr>
        <td>#alertas</td>
        <td><span class="status inativo">Inativo</span></td>
        <td>
          <button class="action-btn btnToggle">Ligar</button>
          <button class="action-btn btnDelete">Deletar</button>
        </td>
      </tr>
    </tbody>
  </table> 
<br>  
    <!-- Nome de Usuário -->
    <section class="funcionalidades">
      <h2>Alterar Nome de Usuário</h2>
      <table class="user-table">
        <thead>
          <tr>
            <th>Nome Atual</th>
            <th>Novo Nome</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>João da Silva</td>
            <td><input type="text" placeholder="Digite o novo nome" /></td>
            <td><button class="action-btn">Salvar</button></td>
          </tr>
        </tbody>
      </table>
    </section>
  
    <!-- E-mail -->
    <section class="funcionalidades">
      <h2>Alterar E-mail</h2>
      <table class="user-table">
        <thead>
          <tr>
            <th>E-mail Atual</th>
            <th>Novo E-mail</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>joao@geoeduca.com</td>
            <td><input type="email" placeholder="Digite o novo e-mail" /></td>
            <td><button class="action-btn">Salvar</button></td>
          </tr>
        </tbody>
      </table>
    </section>
  
    <!-- Senha -->
    <section class="funcionalidades">
      <h2>Alterar Senha</h2>
      <table class="user-table">
        <thead>
          <tr>
            <th>Senha Atual</th>
            <th>Nova Senha</th>
            <th>Confirmar Senha</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><input type="password" placeholder="Senha atual" /></td>
            <td><input type="password" placeholder="Nova senha" /></td>
            <td><input type="password" placeholder="Confirmar nova senha" /></td>
            <td><button class="action-btn">Salvar</button></td>
          </tr>
        </tbody>
      </table>
    </section>

  </div>
</body>
</html>

<!-- SCRIPTS -->
<script src="./JS/logout.js"></script>
<script src="script.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const isAdmin = sessionStorage.USUARIO_ADMIN;
    if (Number(isAdmin) === 1) {
      const navList = document.querySelector(".navbar nav ul");
      const adminNavItem = document.createElement("li");
      adminNavItem.innerHTML = '<a href="../ADM-PAGES/admin.html">Administração</a>';
      navList.insertBefore(adminNavItem, navList.lastElementChild);
    }

    const logoutBtn = document.querySelector(".logout-btn");
    if (logoutBtn) {
      logoutBtn.addEventListener("click", function (event) {
        sessionStorage.clear();
        event.preventDefault();
        window.location.href = logoutBtn.getAttribute("href");
      });
    }
  });

  // Lista mocada de canais Slack
let canaisSlack = [
  { nome: "#geoeduca-info", ativo: true },
  { nome: "#alertas", ativo: false }
];

// Função para renderizar a tabela
function renderSlackTable() {
  const tabela = document.getElementById("tabelaSlack").querySelector("tbody");
  tabela.innerHTML = ""; // limpa antes de renderizar

  canaisSlack.forEach((canal, index) => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${canal.nome}</td>
      <td><span class="status ${canal.ativo ? "ativo" : "inativo"}">
        ${canal.ativo ? "Ativo" : "Inativo"}
      </span></td>
      <td>
        <button class="action-btn btnToggle" data-index="${index}">
          ${canal.ativo ? "Desligar" : "Ligar"}
        </button>
        <button class="action-btn btnDelete" data-index="${index}">Deletar</button>
      </td>
    `;
    tabela.appendChild(row);
  });
}

// Função para adicionar canal
function adicionarCanal(nome) {
  canaisSlack.push({ nome: `#${nome}`, ativo: true });
  renderSlackTable();
}

// Função para alternar status (ligar/desligar)
function toggleCanal(index) {
  canaisSlack[index].ativo = !canaisSlack[index].ativo;
  renderSlackTable();
}

// Função para deletar canal
function deletarCanal(index) {
  canaisSlack.splice(index, 1);
  renderSlackTable();
}

// Inicialização
document.addEventListener("DOMContentLoaded", () => {
  renderSlackTable();

  // Adicionar novo canal
  document.getElementById("btnAdicionarSlack").addEventListener("click", () => {
    const novoCanal = document.getElementById("novoCanalSlack").value.trim();
    if (novoCanal) {
      adicionarCanal(novoCanal);
      document.getElementById("novoCanalSlack").value = "";
    }
  });

  // Delegação de eventos para toggle e delete
  document.getElementById("tabelaSlack").addEventListener("click", (event) => {
    if (event.target.classList.contains("btnToggle")) {
      const index = event.target.getAttribute("data-index");
      toggleCanal(index);
    }
    if (event.target.classList.contains("btnDelete")) {
      const index = event.target.getAttribute("data-index");
      deletarCanal(index);
    }
  });
});
</script>
